<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<link rel="shortcut icon" href="#">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<th:block th:replace="/layout/fragments/head :: headFragment"></th:block>
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>

<body>
<th:block th:replace="/layout/fragments/navbar :: navbarFragment"></th:block>
<div style="margin-top: 300px">
    <div class="card card-body blur shadow-blur mx-3 mx-md-4 mt-n6 mb-4">
        <!-- START Testimonials w/ user image & text & info -->
        <section class="py-sm-7 py-5 position-relative">
            <div class="container">
                <div class="row">
                    <div class="col-12 mx-auto">
                        <div class="mt-n8 mt-md-n9 text-center">
                            <img class="avatar avatar-xxl shadow-xl position-relative z-index-2"
                                 th:src= "@{/class_upload/}+${onClass.onClassFileName}" alt="bruce" loading="lazy">
                        </div>
                        <div class="row py-5">
                            <div class="col-lg-7 col-md-7 z-index-2 position-relative px-md-2 px-sm-5 mx-auto">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <h3 class="mb-0 " th:text="${onClass.onClassTitle}"></h3>
                                </div>
                                <div class="row mb-4">
                                    <div class="col-auto">
                                        <span class="h6" th:text="${onClass.onClassTeacher}"></span>
                                    </div>
                                    <div class="col-auto">
                                        <span class="h6">수업 분야 :</span>
                                        <span th:text="${onClass.onClassCate}"></span>
                                    </div>
                                </div>
                                <div th:text="${onClass.onClassIntro}"></div>
                                <div>
                                    <img th:src= "@{/class_upload/}+${onClass.onClassFileName}" alt="">
                                </div>
                                <div class="border-1">
                                    <p class="text-lg mb-0" th:text="${onClass.onClassContents}"></p>
                                </div>
                                <div>
                                    <span class="h6">수강권 가격 :</span>
                                    <span th:text="${onClass.onClassPrice}"></span>
                                    <span class="h6">point</span>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-success" id="buy-button">수강신청하기</button>
                                    <input type="hidden" id="onClassId" th:value="${onClass.onClassId}">
                                    <input type="hidden" id="memberId" th:value="${session.loginId}">
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>



</div>
</div>
<th:block th:replace="/layout/fragments/script :: scriptFragment"></th:block>
</div>
</body>
<script>
<!--    수강신청버튼 클릭 - 장바구니에 추가 - 나의 장바구니로 이동-->
    $("#buy-button").click(function () {
        const onClassId = $("#onClassId").val();
        const memberId = $("#memberId").val();
        console.log(onClassId + memberId);
        $.ajax({
            type: 'post',
            url: '/cart/save',
            data: {
                'onClassId': onClassId,
                'memberId': memberId
            },
            dataType: 'json',
            success: function () {
                //장바구니에 없다면 저장 후 이동 있다면 그냥 이동
                location.href='/cart/'+memberId;
            },
            error: function () {
                alert('ajax 실패');
            }
        });
    });
</script>
</html>